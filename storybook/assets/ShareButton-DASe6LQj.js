import{j as a}from"./jsx-runtime-u17CrQMm.js";import{r as s}from"./iframe-DnyE1TII.js";function l(r){try{const e=JSON.stringify(r);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}catch(e){return console.error("[Share] Failed to encode data:",e),""}}function y(r){try{let e=r.replace(/-/g,"+").replace(/_/g,"/");for(;e.length%4;)e+="=";const t=atob(e),o=JSON.parse(t);return c(o)?o:(console.error("[Share] Invalid share data structure"),null)}catch(e){return console.error("[Share] Failed to decode data:",e),null}}function c(r){if(typeof r!="object"||r===null)return!1;const e=r;return!(typeof e.version!="number"||e.spreadsheets!==void 0&&!Array.isArray(e.spreadsheets)||e.sheets!==void 0&&!Array.isArray(e.sheets))}async function u(r){if(navigator.clipboard&&navigator.clipboard.writeText)try{return await navigator.clipboard.writeText(r),!0}catch(e){console.error("[Clipboard] API failed, trying fallback:",e)}try{const e=document.createElement("textarea");e.value=r,e.style.position="fixed",e.style.opacity="0",e.style.pointerEvents="none",document.body.appendChild(e),e.select();const t=document.execCommand("copy");return document.body.removeChild(e),t}catch(e){return console.error("[Clipboard] Fallback failed:",e),!1}}function d(r){const e=l(r);if(!e)return"";const t=new URL(window.location.href);return t.searchParams.set("import",e),t.toString()}function p(){const[r,e]=s.useState(!1),t=s.useRef(null);s.useEffect(()=>()=>{t.current!==null&&window.clearTimeout(t.current)},[]);const o=s.useCallback(async i=>{const n=d(i);if(!n){console.error("[Share] Failed to generate share URL"),alert("Failed to generate share link");return}if(!await u(n)){console.error("[Share] Failed to copy to clipboard"),alert("Failed to copy to clipboard");return}e(!0),t.current!==null&&window.clearTimeout(t.current),t.current=window.setTimeout(()=>{e(!1),t.current=null},2e3)},[]);return{isSharing:r,shareData:o}}const h=({data:r,label:e="Share",className:t=""})=>{const{isSharing:o,shareData:i}=p(),n=()=>{i(r)};return a.jsx("button",{type:"button",onClick:n,disabled:o,className:`flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium text-sm sm:text-base whitespace-nowrap transition-colors ${o?"opacity-75":""} ${t}`,"aria-label":o?"Link copied to clipboard":"Share list",children:o?a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}),a.jsx("span",{children:"Copied!"})]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),a.jsx("span",{children:e})]})})};h.__docgenInfo={description:"",methods:[],displayName:"ShareButton",props:{data:{required:!0,tsType:{name:"ShareData"},description:""},label:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Share'",computed:!1}},className:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"''",computed:!1}}}};export{h as S,y as d};
